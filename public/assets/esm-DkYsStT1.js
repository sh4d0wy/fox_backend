import{An as e,Dn as t,Gn as n,Mn as r,Nn as i,On as a,Un as o,jn as s,kn as c}from"./index-CHzPLsRX.js";var l=o(((e,t)=>{var n=Object.prototype.hasOwnProperty,r=`~`;function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(r=!1));function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,n,i,o){if(typeof n!=`function`)throw TypeError(`The listener must be a function`);var s=new a(n,i||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function s(e,t){--e._eventsCount===0?e._events=new i:delete e._events[t]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)n.call(t,i)&&e.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e},c.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,o=Array(a);i<a;i++)o[i]=n[i].fn;return o},c.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},c.prototype.emit=function(e,t,n,i,a,o){var s=r?r+e:e;if(!this._events[s])return!1;var c=this._events[s],l=arguments.length,u,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,a),!0;case 6:return c.fn.call(c.context,t,n,i,a,o),!0}for(d=1,u=Array(l-1);d<l;d++)u[d-1]=arguments[d];c.fn.apply(c.context,u)}else{var f=c.length,p;for(d=0;d<f;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),l){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,n);break;case 4:c[d].fn.call(c[d].context,t,n,i);break;default:if(!u)for(p=1,u=Array(l-1);p<l;p++)u[p-1]=arguments[p];c[d].fn.apply(c[d].context,u)}}return!0},c.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},c.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},c.prototype.removeListener=function(e,t,n,i){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn===t&&(!i||o.once)&&(!n||o.context===n)&&s(this,a);else{for(var c=0,l=[],u=o.length;c<u;c++)(o[c].fn!==t||i&&!o[c].once||n&&o[c].context!==n)&&l.push(o[c]);l.length?this._events[a]=l.length===1?l[0]:l:s(this,a)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,t!==void 0&&(t.exports=c)}));i();var u=n(l(),1).default,d=o(((e,t)=>{function n(e){if(e.length>=255)throw TypeError(`Alphabet too long`);for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var i=e.charAt(r),a=i.charCodeAt(0);if(t[a]!==255)throw TypeError(i+` is ambiguous`);t[a]=r}var o=e.length,s=e.charAt(0),c=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function u(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError(`Expected Uint8Array`);if(t.length===0)return``;for(var n=0,r=0,i=0,a=t.length;i!==a&&t[i]===0;)i++,n++;for(var c=(a-i)*l+1>>>0,u=new Uint8Array(c);i!==a;){for(var d=t[i],f=0,p=c-1;(d!==0||f<r)&&p!==-1;p--,f++)d+=256*u[p]>>>0,u[p]=d%o>>>0,d=d/o>>>0;if(d!==0)throw Error(`Non-zero carry`);r=f,i++}for(var m=c-r;m!==c&&u[m]===0;)m++;for(var h=s.repeat(n);m<c;++m)h+=e.charAt(u[m]);return h}function d(e){if(typeof e!=`string`)throw TypeError(`Expected String`);if(e.length===0)return new Uint8Array;for(var n=0,r=0,i=0;e[n]===s;)r++,n++;for(var a=(e.length-n)*c+1>>>0,l=new Uint8Array(a);e[n];){var u=e.charCodeAt(n);if(u>255)return;var d=t[u];if(d===255)return;for(var f=0,p=a-1;(d!==0||f<i)&&p!==-1;p--,f++)d+=o*l[p]>>>0,l[p]=d%256>>>0,d=d/256>>>0;if(d!==0)throw Error(`Non-zero carry`);i=f,n++}for(var m=a-i;m!==a&&l[m]===0;)m++;for(var h=new Uint8Array(r+(a-m)),g=r;m!==a;)h[g++]=l[m++];return h}function f(e){var t=d(e);if(t)return t;throw Error(`Non-base`+o+` character`)}return{encode:u,decodeUnsafe:d,decode:f}}t.exports=n})),f=o(((e,t)=>{t.exports=d()(`123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz`)})),p,m=new Uint8Array(16);function h(){if(!p&&(p=typeof crypto<`u`&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!p))throw Error(`crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported`);return p(m)}var g=[];for(let e=0;e<256;++e)g.push((e+256).toString(16).slice(1));function _(e,t=0){return g[e[t+0]]+g[e[t+1]]+g[e[t+2]]+g[e[t+3]]+`-`+g[e[t+4]]+g[e[t+5]]+`-`+g[e[t+6]]+g[e[t+7]]+`-`+g[e[t+8]]+g[e[t+9]]+`-`+g[e[t+10]]+g[e[t+11]]+g[e[t+12]]+g[e[t+13]]+g[e[t+14]]+g[e[t+15]]}var v={randomUUID:typeof crypto<`u`&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function y(e,t,n){if(v.randomUUID&&!t&&!e)return v.randomUUID();e||={};let r=e.random||(e.rng||h)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){n||=0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return _(r)}var b=y,x=n(f());function S(e){return e.version===void 0}function C(e){return S(e)?e.serialize({verifySignatures:!1,requireAllSignatures:!1}):e.serialize()}var w=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})};function T(e){return w(this,void 0,void 0,function*(){try{return yield e.request({method:`wallet_getSnaps`}),!0}catch{return!1}})}function E(){return w(this,void 0,void 0,function*(){try{let e=window.ethereum;if(!e)return null;if(e.providers&&Array.isArray(e.providers)){let t=e.providers;for(let e of t)if(yield T(e))return e}if(e.detected&&Array.isArray(e.detected)){let t=e.detected;for(let e of t)if(yield T(e))return e}return(yield T(e))?e:null}catch(e){return console.error(e),null}})}const D=[`solana:mainnet`,`solana:devnet`,`solana:testnet`,`solana:localnet`];function O(e){return D.includes(e)}var k=function(e,t,n,r){if(n===`a`&&!r)throw TypeError(`Private accessor was defined without a getter`);if(typeof t==`function`?e!==t||!r:!t.has(e))throw TypeError(`Cannot read private member from an object whose class did not declare it`);return n===`m`?r:n===`a`?r.call(e):r?r.value:t.get(e)},A=function(e,t,n,r,i){if(r===`m`)throw TypeError(`Private method is not writable`);if(r===`a`&&!i)throw TypeError(`Private accessor was defined without a setter`);if(typeof t==`function`?e!==t||!i:!t.has(e))throw TypeError(`Cannot write private member to an object whose class did not declare it`);return r===`a`?i.call(e,n):i?i.value=n:t.set(e,n),n},j,M,N,P,F,I,L=D,R=[c,t,a],z=class e{get address(){return k(this,j,`f`)}get publicKey(){return k(this,M,`f`).slice()}get chains(){return k(this,N,`f`).slice()}get features(){return k(this,P,`f`).slice()}get label(){return k(this,F,`f`)}get icon(){return k(this,I,`f`)}constructor({address:t,publicKey:n,label:r,icon:i}){j.set(this,void 0),M.set(this,void 0),N.set(this,void 0),P.set(this,void 0),F.set(this,void 0),I.set(this,void 0),new.target===e&&Object.freeze(this),A(this,j,t,`f`),A(this,M,n,`f`),A(this,N,L,`f`),A(this,P,R,`f`),A(this,F,r,`f`),A(this,I,i,`f`)}};j=new WeakMap,M=new WeakMap,N=new WeakMap,P=new WeakMap,F=new WeakMap,I=new WeakMap;var B=function(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})},V=class t extends u{constructor(e){super(),this._network=`mainnet-beta`,this._iframeParams={},this._element=null,this._iframe=null,this._publicKey=null,this._account=null,this._isConnected=!1,this._connectHandler=null,this._messageHandlers={},this._handleEvent=e=>{switch(e.type){case`connect`:this._collapseIframe(),e.data?.publicKey?(this._publicKey=e.data.publicKey,this._isConnected=!0,this._connectHandler&&=(this._connectHandler.resolve(),null),this._connected()):(this._connectHandler&&=(this._connectHandler.reject(),null),this._disconnected());return;case`disconnect`:this._connectHandler&&=(this._connectHandler.reject(),null),this._disconnected();return;case`accountChanged`:e.data?.publicKey?(this._publicKey=e.data.publicKey,this.emit(`accountChanged`,this.publicKey),this._standardConnected()):(this.emit(`accountChanged`,void 0),this._standardDisconnected());return;default:return}},this._handleResize=e=>{e.resizeMode===`full`?e.params.mode===`fullscreen`?this._expandIframe():e.params.mode===`hide`&&this._collapseIframe():e.resizeMode===`coordinates`&&this._resizeIframe(e.params)},this._handleMessage=e=>{if(e.data?.channel!==`solflareIframeToWalletAdapter`)return;let t=e.data.data||{};if(t.type===`event`)this._handleEvent(t.event);else if(t.type===`resize`)this._handleResize(t);else if(t.type===`response`&&this._messageHandlers[t.id]){let{resolve:e,reject:n}=this._messageHandlers[t.id];delete this._messageHandlers[t.id],t.error?n(t.error):e(t.result)}},this._removeElement=()=>{this._element&&=(this._element.remove(),null)},this._removeDanglingElements=()=>{let e=document.getElementsByClassName(`solflare-metamask-wallet-adapter-iframe`);for(let t of e)t.parentElement&&t.remove()},this._injectElement=()=>{this._removeElement(),this._removeDanglingElements();let e=Object.assign(Object.assign({},this._iframeParams),{mm:!0,v:1,cluster:this._network||`mainnet-beta`,origin:window.location.origin||``,title:document.title||``}),n=Object.keys(e).map(t=>`${t}=${encodeURIComponent(e[t])}`).join(`&`),r=`${t.IFRAME_URL}?${n}`;this._element=document.createElement(`div`),this._element.className=`solflare-metamask-wallet-adapter-iframe`,this._element.innerHTML=`
      <iframe src='${r}' style='position: fixed; top: 0; bottom: 0; left: 0; right: 0; width: 100%; height: 100%; border: none; border-radius: 0; z-index: 99999; color-scheme: auto;' allowtransparency='true'></iframe>
    `,document.body.appendChild(this._element),this._iframe=this._element.querySelector(`iframe`),window.addEventListener(`message`,this._handleMessage,!1)},this._collapseIframe=()=>{this._iframe&&(this._iframe.style.top=``,this._iframe.style.right=``,this._iframe.style.height=`2px`,this._iframe.style.width=`2px`)},this._expandIframe=()=>{this._iframe&&(this._iframe.style.top=`0px`,this._iframe.style.bottom=`0px`,this._iframe.style.left=`0px`,this._iframe.style.right=`0px`,this._iframe.style.width=`100%`,this._iframe.style.height=`100%`)},this._resizeIframe=e=>{this._iframe&&(this._iframe.style.top=isFinite(e.top)?`${e.top}px`:``,this._iframe.style.bottom=isFinite(e.bottom)?`${e.bottom}px`:``,this._iframe.style.left=isFinite(e.left)?`${e.left}px`:``,this._iframe.style.right=isFinite(e.right)?`${e.right}px`:``,this._iframe.style.width=isFinite(e.width)?`${e.width}px`:e.width,this._iframe.style.height=isFinite(e.height)?`${e.height}px`:e.height)},this._sendIframeMessage=e=>{if(!this.connected||!this.publicKey)throw Error(`Wallet not connected`);return new Promise((t,n)=>{var r;let i=b();this._messageHandlers[i]={resolve:t,reject:n},(r=this._iframe?.contentWindow)==null||r.postMessage({channel:`solflareWalletAdapterToIframe`,data:Object.assign({id:i},e)},`*`)})},this._connected=()=>{this._isConnected=!0,this.emit(`connect`,this.publicKey),this._standardConnected()},this._disconnected=()=>{this._publicKey=null,this._isConnected=!1,window.removeEventListener(`message`,this._handleMessage,!1),this._removeElement(),this.emit(`disconnect`),this._standardDisconnected()},this._standardConnected=()=>{if(!this.publicKey)return;let e=this.publicKey.toString();(!this._account||this._account.address!==e)&&(this._account=new z({address:e,publicKey:this.publicKey.toBytes()}),this.emit(`standard_change`,{accounts:this.standardAccounts}))},this._standardDisconnected=()=>{this._account&&(this._account=null,this.emit(`standard_change`,{accounts:this.standardAccounts}))},e?.network&&(this._network=e?.network),window.SolflareMetaMaskParams&&(this._iframeParams=Object.assign(Object.assign({},this._iframeParams),window.SolflareMetaMaskParams)),e?.params&&(this._iframeParams=Object.assign(Object.assign({},this._iframeParams),e?.params))}get publicKey(){return this._publicKey?new e(this._publicKey):null}get standardAccount(){return this._account}get standardAccounts(){return this._account?[this._account]:[]}get isConnected(){return this._isConnected}get connected(){return this.isConnected}get autoApprove(){return!1}connect(){return B(this,void 0,void 0,function*(){this.connected||(this._injectElement(),yield new Promise((e,t)=>{this._connectHandler={resolve:e,reject:t}}))})}disconnect(){return B(this,void 0,void 0,function*(){yield this._sendIframeMessage({method:`disconnect`}),this._disconnected()})}signTransaction(e){return B(this,void 0,void 0,function*(){if(!this.connected||!this.publicKey)throw Error(`Wallet not connected`);try{let t=C(e),{transaction:n}=yield this._sendIframeMessage({method:`signTransactionV2`,params:{transaction:x.default.encode(t)}});return S(e)?s.from(x.default.decode(n)):r.deserialize(x.default.decode(n))}catch(e){throw Error((e?.toString)?.call(e)||`Failed to sign transaction`)}})}signAllTransactions(e){return B(this,void 0,void 0,function*(){if(!this.connected||!this.publicKey)throw Error(`Wallet not connected`);try{let t=e.map(e=>C(e)),{transactions:n}=yield this._sendIframeMessage({method:`signAllTransactionsV2`,params:{transactions:t.map(e=>x.default.encode(e))}});return n.map((t,n)=>S(e[n])?s.from(x.default.decode(t)):r.deserialize(x.default.decode(t)))}catch(e){throw Error((e?.toString)?.call(e)||`Failed to sign transactions`)}})}signAndSendTransaction(e,t){return B(this,void 0,void 0,function*(){if(!this.connected||!this.publicKey)throw Error(`Wallet not connected`);try{let n=C(e),{signature:r}=yield this._sendIframeMessage({method:`signAndSendTransaction`,params:{transaction:x.default.encode(n),options:t}});return r}catch(e){throw Error((e?.toString)?.call(e)||`Failed to sign and send transaction`)}})}signMessage(e,t=`utf8`){return B(this,void 0,void 0,function*(){if(!this.connected||!this.publicKey)throw Error(`Wallet not connected`);try{let{signature:n}=yield this._sendIframeMessage({method:`signMessage`,params:{data:x.default.encode(e),display:t}});return Uint8Array.from(x.default.decode(n))}catch(e){throw Error((e?.toString)?.call(e)||`Failed to sign message`)}})}sign(e,t=`utf8`){return B(this,void 0,void 0,function*(){return yield this.signMessage(e,t)})}static isSupported(){return B(this,void 0,void 0,function*(){return!!(yield E())})}standardSignAndSendTransaction(...e){return B(this,void 0,void 0,function*(){if(!this.connected)throw Error(`not connected`);let t=[];if(e.length===1){let{transaction:n,account:i,chain:a,options:o}=e[0],{minContextSlot:s,preflightCommitment:c,skipPreflight:l,maxRetries:u}=o||{};if(i!==this._account)throw Error(`invalid account`);if(!O(a))throw Error(`invalid chain`);let d=yield this.signAndSendTransaction(r.deserialize(n),{preflightCommitment:c,minContextSlot:s,maxRetries:u,skipPreflight:l});t.push({signature:x.default.decode(d)})}else if(e.length>1)for(let n of e)t.push(...yield this.standardSignAndSendTransaction(n));return t})}standardSignTransaction(...e){return B(this,void 0,void 0,function*(){if(!this.connected)throw Error(`not connected`);let t=[];if(e.length===1){let{transaction:n,account:i,chain:a}=e[0];if(i!==this._account)throw Error(`invalid account`);if(a&&!O(a))throw Error(`invalid chain`);let o=yield this.signTransaction(r.deserialize(n));t.push({signedTransaction:o.serialize()})}else if(e.length>1){let n;for(let t of e){if(t.account!==this._account)throw Error(`invalid account`);if(t.chain){if(!O(t.chain))throw Error(`invalid chain`);if(n){if(t.chain!==n)throw Error(`conflicting chain`)}else n=t.chain}}let i=e.map(({transaction:e})=>r.deserialize(e)),a=yield this.signAllTransactions(i);t.push(...a.map(e=>({signedTransaction:e.serialize()})))}return t})}standardSignMessage(...e){return B(this,void 0,void 0,function*(){if(!this.connected)throw Error(`not connected`);let t=[];if(e.length===1){let{message:n,account:r}=e[0];if(r!==this._account)throw Error(`invalid account`);let i=yield this.signMessage(n);t.push({signedMessage:n,signature:i})}else if(e.length>1)for(let n of e)t.push(...yield this.standardSignMessage(n));return t})}};V.IFRAME_URL=`https://widget.solflare.com/`;var H=V;export{z as StandardSolflareMetaMaskWalletAccount,H as default};